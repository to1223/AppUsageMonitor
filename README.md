# AppUsageMonitor

## 概要

指定したアプリ（プロセス名）の起動状況等を一定周期で取得し、ファイルに書き出します。

Windows 10 / 11 の標準環境（.NET Framework 4.0）でビルド・動作するように作っています。


## 動作環境

- .NET Framework v4.0.30319
- MSBuild version 4.8.9032.0
- C# Compiler version 4.8.9232.0 (for C# 5)

## 使い方

### ソースからのビルド

1. ソースをダウンロードし、プロジェクトのフォルダ（`AppUsageMonitor.csproj`ファイルのあるフォルダ）に移動します。
2. コマンドプロンプトかPowerShellを開き、`scripts\build.bat`を実行します。
3. `bin\Release`フォルダ以下に、実行ファイルと設定ファイルが作成されます。
4. 上記フォルダ以下のファイルたちは別のフォルダに移動可能です。

### 設定ファイルの修正

`settings`フォルダ以下のファイルを修正します。
- `interval_seconds`: モニタリングの時間間隔を秒単位の整数値で指定します。
- `output_folder`: モニタリング記録を出力するフォルダを指定します。絶対パスでない場合は実行ファイルがあるフォルダからの相対パスになります。
- `process_name`: 監視するアプリの名前を指定します。タスクマネージャーで"Process name"列を表示させて目的のアプリのプロセス名を調べ、末尾の".exe"を除いた文字列を指定します。
- `target_pc`: 監視対象のPC名を指定します。複数行指定できます。このリストに無いPCからは、プログラムは起動しません。

### 実行

実行ファイルをダブルクリックするか、コマンドラインから実行します。

タスクトレイにアイコンが表示されます。

設定ファイルで指定した出力先フォルダに、`yyyy-MM-dd_<PC名>.txt`が生成され、監視結果が記録されていきます。

### 終了

タスクトレイのアイコンを右クリックし、"AppUsageMonitorを終了"を選択します。

### 出力の確認

出力ファイルの行のフォーマットは`yyyy-MM-dd HH:mm:ss <ユーザー名> <画面ロック状態> <アプリ起動状態>`です。画面ロック状態はLocked/Unlocked、アプリ起動状態はUp/Downが入ります。

## 免責事項

このアプリは、日曜プログラマーが趣味で勉強しながら開発しています。本アプリを使用することによるいかなる事態に対しても開発者は責任を負いません。

## ライセンス

本アプリで使用しているアイコンは、Apache License 2.0 でライセンスされたデータを使用しています。（https://icon-icons.com/ja/%E3%82%A2%E3%82%A4%E3%82%B3%E3%83%B3/%E3%83%A2%E3%83%8B%E3%82%BF%E3%83%BC-%E7%9C%BC/138368）

その他の部分については、改変、商用利用含め、ご自由にお使いください。